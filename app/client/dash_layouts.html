<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Dashboard{% endblock %}</title>
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script defer="defer" src="https://cdn.jsdelivr.net/gh/JiaLe0709/cdn@latest/js/lms.min.js"></script>
    <link href="https://cdn.jsdelivr.net/gh/JiaLe0709/cdn@latest/css/lms.min.css" rel="stylesheet">
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}" />
    <style>
        .activated {
            color: #313435
        }
    </style>
    {% block head %}
    {% endblock %}
</head>

<body class="app">
    <div id="loader">
        <div class="spinner"></div>
    </div>
    <div class="sidebar">
        <div class="sidebar-inner">
            <div class="sidebar-logo">
                <div class="peers ai-c fxw-nw">
                    <div class="peer peer-greed">
                        <a class="sidebar-link td-n" href="{{ url_for('root.home') }}">
                            <div class="peers ai-c fxw-nw">
                                <div class="peer">
                                    <div class="logo">
                                        <img src="{{ url_for('static', filename='favicon.ico') }}" width="45px"
                                            height="45px" alt="Logo">
                                    </div>
                                </div>
                                <div class="peer peer-greed">
                                    <h5 class="lh-1 mB-0 logo-text">Dashboard</h5>
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="peer">
                        <div class="mobile-toggle sidebar-toggle">
                            <a href="" class="td-n">
                                <i class="ti-arrow-circle-left"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <ul class="sidebar-menu scrollable pos-r">
                <li class="nav-item mT-30 ">
                    <a class="sidebar-link" href="{{ url_for('root.home') }}">
                        <span class="icon-holder">
                            <i class="c-blue-500 ti-home"></i>
                        </span>
                        <span
                            class="title {% if request.path == url_for('root.home') %}activated{% endif %}">Home</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="sidebar-link" href="{{ url_for('borrow.home') }}">
                        <span class="icon-holder">
                            <i class="c-teal-500 ti-book"></i>
                        </span>
                        <span class="title {% if request.path == url_for('borrow.home') %}activated{% endif %}">Borrow
                            Books</span>
                    </a>
                </li>
                <li class="nav-item dropdown">
                    <a class="dropdown-toggle">
                        <span class="icon-holder">
                            <i class="c-orange-500 ti-layout-list-thumb"></i>
                        </span>
                        <span
                            class="title {% if request.path == url_for('member.home') or request.path == url_for('member.new_member') %}activated{% endif %}">Member</span>
                        <span class="arrow">
                            <i class="ti-angle-right"></i>
                        </span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="sidebar-link" href="{{ url_for('member.home') }}"><span
                                    class="{% if request.path == url_for('member.home') %}activated{% endif %}">Member</span></a>
                        </li>
                        <li>
                            <a class="sidebar-link" href="{{ url_for('member.new_member') }}"><span
                                    class="{% if request.path == url_for('member.new_member') %}activated{% endif %}">Create
                                    New Member</span></a>
                        </li>
                    </ul> 
                </li>
                <li class="nav-item dropdown">
                    <a class="dropdown-toggle">
                        <span class="icon-holder">
                            <i class="c-orange-500 ti-pencil-alt"></i>
                        </span>
                        <span
                            class="title {% if request.path == url_for('books.home') or request.path == url_for('books.home')  %}activated{% endif %}">Books</span>
                        <span class="arrow">
                            <i class="ti-angle-right"></i>
                        </span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="sidebar-link" href="{{ url_for('books.home') }}"><span
                                    class="{% if request.path == url_for('member.home') %}activated{% endif %}">Books</span></a>
                        </li>
                        <li>
                            <a class="sidebar-link" href="{{ url_for('books.new_books') }}"><span
                                    class="{% if request.path == url_for('books.new_books') %}activated{% endif %}">Create
                                    New Books Record</span></a>
                        </li>
                    </ul> 
                </li>
                <li class="nav-item">
                    <a class="sidebar-link" href="{{ url_for('settings.home') }}">
                        <span class="icon-holder">
                            <i class="c-teal-500 ti-settings"></i>
                        </span>
                        <span class="title {% if request.path == url_for('settings.home') %}activated{% endif %}">Settings</span>
                    </a>
                </li>
                <li class="nav-item mT-30 actived">
                    <a class="sidebar-link" href="{{ url_for('auth.logout') }}">
                        <span class="icon-holder">
                            <i class="c-blue-500 ti-lock"></i>
                        </span>
                        <span class="title">Logout</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="page-container">
        <div class="header navbar">
            <div class="header-container">
                <ul class="nav-left">
                    <li>
                        <a id="sidebar-toggle" class="sidebar-toggle" href="javascript:void(0);">
                            <i class="ti-menu"></i>
                        </a>
                    </li>

                </ul>
                <ul class="nav-right">
                    <li class="dropdown">
                        <a href="" class="dropdown-toggle no-after peers fxw-nw ai-c lh-1" data-bs-toggle="dropdown">
                            <div class="peer mR-10">
                                <img class="w-2r bdrs-50p" id="gravatarImage" src="" alt="Profile">
                            </div>
                            <div class="peer">
                                <span class="fsz-sm c-grey-900">{{ current_user.username }}</span>
                            </div>
                        </a>
                        <ul class="dropdown-menu fsz-sm">
                            <li>
                                <a href="{{ url_for('settings.home') }}" class="d-b td-n pY-5 bgcH-grey-100 c-grey-700">
                                    <i class="ti-settings mR-10"></i>
                                    <span>Setting</span>
                                </a>
                            </li>
                            <!--li>
                                <a href="" class="d-b td-n pY-5 bgcH-grey-100 c-grey-700">
                                    <i class="ti-user mR-10"></i>
                                    <span>Profile</span>
                                </a>
                            </li>
                            <li>
                                <a href="email.html" class="d-b td-n pY-5 bgcH-grey-100 c-grey-700">
                                    <i class="ti-email mR-10"></i>
                                    <span>Messages</span>
                                </a>
                            </li>
                            <li role="separator" class="divider"></li-->
                            <li>
                                <a href="{{ url_for('auth.logout') }}" class="d-b td-n pY-5 bgcH-grey-100 c-grey-700">
                                    <i class="ti-power-off mR-10"></i>
                                    <span>Logout</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <main class="main-content bgc-grey-100">
            <div id="mainContent">
                {% block body %}
                {% endblock %}
            </div>
        </main>
        <footer class="bdT ta-c p-30 lh-0 fsz-sm c-grey-600">
            <span>Copyright Â©
                <script type="text/javascript">var year = new Date(); document.write(year.getFullYear());</script> Code
                by <a href="https://github.com/jiale0709" target="_blank" title="Jia Le">Jia Le</a>.
            </span>
        </footer>


    </div>
    {% block script %}
    {% endblock %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/core.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/md5.js"></script>
    <script>
        function getGravatarUrl(email, size = 80) {
            const hash = CryptoJS.MD5(email.toLowerCase().trim());
            return `https://www.gravatar.com/avatar/${hash}?s=${size}`;
        }

        const email = '{{ current_user.email }}';
        const gravatarUrl = getGravatarUrl(email);

        const gravatarImage = document.getElementById('gravatarImage');
        gravatarImage.src = gravatarUrl;
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>
    <script>
        console.log('Repo: https://github.com/jiale0709/library-management')
    </script>
    <script>
        window.addEventListener('load', function load() {
            const loader = document.getElementById('loader');
            setTimeout(function () {
                loader.classList.add('fadeOut');
            }, 300);
        });
    </script>
</body>

</html>